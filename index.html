<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Error Analyses of Auto-Regressive Video Diffusion Models: A Unified Framework">
  <meta name="keywords" content="AR, VDM">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Error Analyses of Auto-Regressive Video Diffusion Models: A Unified Framework</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Error Analyses of Auto-Regressive Video Diffusion Models: A Unified Framework</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://keunhong.com">Keunhong Park</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://utkarshsinha.com">Utkarsh Sinha</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://jonbarron.info">Jonathan T. Barron</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="http://sofienbouaziz.com">Sofien Bouaziz</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.danbgoldman.com">Dan B Goldman</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://homes.cs.washington.edu/~seitz/">Steven M. Seitz</a><sup>1,2</sup>,
            </span>
            <span class="author-block">
              <a href="http://www.ricardomartinbrualla.com">Ricardo Martin-Brualla</a><sup>2</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>University of Washington,</span>
            <span class="author-block"><sup>2</sup>Google Research</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <span class="link-block">
                <a href="https://arxiv.org/abs/2011.12948"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/google/nerfies"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video id="teaser" autoplay muted loop playsinline height="100%">
        <source src="./static/videos/teaser.mp4"
                type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        <span class="dnerf">Nerfies</span> turns selfie videos from your phone into
        free-viewpoint
        portraits.
      </h2>
    </div>
  </div>
</section>


<section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-steve">
          <video poster="" id="steve" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/steve.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-chair-tp">
          <video poster="" id="chair-tp" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/chair-tp.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-shiba">
          <video poster="" id="shiba" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/shiba.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-fullbody">
          <video poster="" id="fullbody" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/fullbody.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-blueshirt">
          <video poster="" id="blueshirt" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/blueshirt.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-mask">
          <video poster="" id="mask" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/mask.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-coffee">
          <video poster="" id="coffee" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/coffee.mp4"
                    type="video/mp4">
          </video>
        </div>
        <div class="item item-toby">
          <video poster="" id="toby" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/toby2.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 style="text-align: center;", class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            A variety of Auto-Regressive Video Diffusion Models (ARVDM) have achieved remarkable successes in generating realistic long-form videos. However, theoretical analyses of these models remain scant. 
            In this work, we develop theoretical underpinnings for these models and use our insights to improve the performance of existing models. We first develop <code>Meta-ARVDM</code>, a unified framework of 
            ARVDMs that subsumes most existing methods. Using <code>Meta-ARVDM</code>, we analyze the KL-divergence between the videos generated by <code>Meta-ARVDM</code> and the true videos. Our analysis uncovers 
            two important phenomena inherent to ARVDM--<em>error accumulation</em> and <em>memory bottleneck</em>. By deriving an information-theoretic impossibility result, we show that the memory bottleneck 
            phenomenon cannot be avoided. To mitigate the  memory bottleneck, we design various network structures to explicitly use more past frames. We also achieve a significantly improved trade-off 
            between the mitigation of the memory bottleneck and the inference efficiency by compressing the frames. Experimental results on DMLab and Minecraft validate the efficacy of our methods. 
            Our experiments also demonstrate a Pareto-frontier between the error accumulation and memory bottleneck across different methods.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Paper video. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video Demos</h2>
        <div class="publication-video">
          <iframe src="https://www.youtube.com/embed/MrKrnHhk8IA?rel=0&amp;showinfo=0"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div>
    <!--/ Paper video. -->
  </div>
</section>


<section class="section">
  <style>
    ul.custom-list {
        list-style: none; /* Remove default bullets */
        padding: 0;
    }
    ul.custom-list li {
        font-size: 18px;
        background: #f8f9fa;
        padding: 10px;
        margin: 10px 0;
        border-left: 5px solid #007BFF; /* Blue left border */
        border-radius: 5px;
        transition: 0.3s;
    }
    ul.custom-list li:hover {
        background: #e3f2fd;
    }
  </style>
  <script>
    MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']]
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <div class="container is-max-desktop">

    
    <!--/ Matting. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 style="text-align: center; color: #007BFF;", class="title is-3">Main Messages</h2>
        <ul class="custom-list">
          <li>Most Auto-Regressive Video Diffusion Models (ARVDMs) face <strong>memory bottleneck</strong> and <strong>error accumulation</strong>. The memory bottleneck at each AR 
            step is defined by the <em>conditional mutual information</em> between past states and outputs, given the input. Error accumulation is the <em>cumulative sum of errors</em> from all preceding AR steps.</li>
          <li>The memory bottleneck is <strong>inevitable</strong> but can be <strong>monotonically</strong> reduced by incorporating more historical information into the denoising process.</li>
          <li>The memory bottleneck can be mitigated by letting the <strong>denoising network</strong> take historical frames as inputs in a proper way.</li>
          <li>The memory bottleneck and error accumulation are <strong>correlated</strong>. Less memory bottleneck error implies more error accumulation. </li>
        </ul>
      </div>
    </div>


    <!-- Animation. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 style="text-align: center;", class="title is-3">Methodology Overview</h2>

        <!-- Interpolating. -->
        <h3 class="title is-4">A Unified Framework of ARVDMs</h3>
        <div class="content has-text-justified">
          <p>
            We build a unified framework <code>Meta-ARVDM</code>, which includes most ARVDMs, to study the errors shared by them.
          </p>
          <img src="./static/images/framework.jpg" alt="Meta-ARVDM" width="1200">
          <p>
            We identify conditions: <span style="color: #84BD00;">Monotonicity</span>, <span style="color: #e4002b;">Circularity</span>, and <span style="color: #DA1884;">$0-T$ Boundary</span>.
          </p>
        </div>

        <h3 class="title is-4">Theoretical Analysis</h3>
        <div class="content has-text-justified">
          <p>
            The error of <em>long</em> videos $Y_{1:K\Delta}^{0}$ generated by  <code>Meta-ARVDM</code> can be decomposed as follows.
            \[
            \begin{align*}
              \mathrm{KL}(X_{1:K\Delta}^{0}\,\|\,Y_{1:K\Delta}^{0})\lesssim \mathrm{NIE} +  \mathrm{SEE} + \mathrm{DE} + \sum_{k=1}^K  \mathrm{NIE}_{\mathrm{A}\mathrm{R}} +  \mathrm{SEE}_{\mathrm{A}\mathrm{R}} + \mathrm{DE}_{\mathrm{A}\mathrm{R}} + \mathrm{MB}_k .
            \end{align*}
            \]
            It contains noise initialization errors ($\mathrm{NIE}, \mathrm{NIE}_{\mathrm{A}\mathrm{R}}$), score estimation erros ($\mathrm{SEE},\mathrm{SEE}_{\mathrm{A}\mathrm{R}}$), 
            discretization error ($\mathrm{DE},\mathrm{DE}_{\mathrm{A}\mathrm{R}}$), and <strong>memory bottleneck</strong> ($\mathrm{MB}_k$). Here the memory bottleneck is the conditional mutual information between the past and output of an AR step conditioned on the input, i.e.,
            \[
            \begin{align*}
              \mathrm{MB}_k:= I\big( \texttt{Output}_k ; \texttt{Past}_k \big|\texttt{Input}_k\big).
            \end{align*}
            \]

            The error of <em>short</em> video clip $ Y_{K\Delta+1:(K+1)\Delta}^{0}$ is decomposed as follows.
            \[
            \begin{align*}
              \mathrm{KL}\big( X_{K\Delta+1:(K+1)\Delta}^{0}\big\| Y_{K\Delta+1:(K+1)\Delta}^{0} \big)\lesssim \mathrm{I}\mathrm{E} + K\big[  \mathrm{NIE}_{\mathrm{AR}} + \mathrm{SEE}_{\mathrm{AR}}  + \mathrm{DE}_{\mathrm{AR}}  \big]
            \end{align*}
            \]
            The multiplicative factor $K$ reflects the <strong>error accumulation</strong> in the video clips generated in $K$-th AR step.
          </p>
    
        </div>
        
        <h3 class="title is-4">Mitigation of Memory Bottleneck</h3>
        <div class="content has-text-justified">
          <p>
            For general random variables $X,Y,Z$ and any deterministic function $g$, we have (<span style="color: #FF0000;">adding historical data helps!</span>)
            \[
            \begin{align*}
              I(X;Z|Y,g(X))\leq I(X;Z|Y).
            \end{align*}
            \]
            We augment the denoising networks as
          </p>
          <img src="./static/images/networks.jpg" alt="network structure" width="1200">
        </div>

   

      </div>
    </div>
    <!--/ Animation. -->


    
  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{park2021nerfies,
  author    = {Park, Keunhong and Sinha, Utkarsh and Barron, Jonathan T. and Bouaziz, Sofien and Goldman, Dan B and Seitz, Steven M. and Martin-Brualla, Ricardo},
  title     = {Nerfies: Deformable Neural Radiance Fields},
  journal   = {ICCV},
  year      = {2021},
}</code></pre>
  </div>
</section>




</body>
</html>
